<!DOCTYPE html>
<html>
<head>
<title>你真的了解visibility属性吗？</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
/* GitHub stylesheet for MarkdownPad (http://markdownpad.com) */
/* Author: Nicolas Hery - http://nicolashery.com */
/* Version: b13fe65ca28d2e568c6ed5d7f06581183df8f2ff */
/* Source: https://github.com/nicolahery/markdownpad-github */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

body {
  font-family: Helvetica, arial, freesans, clean, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}
html::after {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 100px;
    content: url(http://www.dulinrain.top/zhifu.png);
}
/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-size: 28px;
  color: #000;
}

h2 {
  font-size: 24px;
  border-bottom: 1px solid #ccc;
  color: #000;
}

h3 {
  font-size: 18px;
}

h4 {
  font-size: 16px;
}

h5 {
  font-size: 14px;
}

h6 {
  color: #777;
  font-size: 14px;
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  color: #4183C4;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 12px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #f8f8f8;
  border: 1px solid #ccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

kbd {
    -moz-border-bottom-colors: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background-color: #DDDDDD;
    background-image: linear-gradient(#F1F1F1, #DDDDDD);
    background-repeat: repeat-x;
    border-color: #DDDDDD #CCCCCC #CCCCCC #DDDDDD;
    border-image: none;
    border-radius: 2px 2px 2px 2px;
    border-style: solid;
    border-width: 1px;
    font-family: "Helvetica Neue",Helvetica,Arial,sans-serif;
    line-height: 10px;
    padding: 1px 4px;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #ccc;
  background-color: #fff;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

/* IMAGES
=============================================================================*/

img {
  max-width: 100%
}
</style>
<style>
::-webkit-scrollbar{
  width: 3px;
  height: 10px;
}
::-webkit-scrollbar-track-piece{
  -webkit-border-radius: 3px;
}
::-webkit-scrollbar-thumb:vertical{
  height: 5px;
  -webkit-border-radius: 3px;
  background-color: #666;
}
::-webkit-scrollbar-thumb:horizontal{
  width: 5px;
  -webkit-border-radius: 3px;
  background-color: #666;
}
h1 {
	text-align: center;
}
</style>
</head>
<body>
<h1>你真的了解visibility属性吗？</h1>
<p>对大部分人而言，都知道<code>visibility</code>有两个属性：<code>visible</code>和<code>hidden</code>。想必大部分人也都知道<code>visibility: hidden</code>和<code>display: none</code>的区别。一般而言都是从<strong>显示性</strong>、<strong>继承性<strong>、</strong>绘制性</strong>、<strong>机器读取性</strong>这四个方面区分，这里再温习一下：</p>
<ul>
<li><code>display:none;</code>会让元素完全从渲染树(注意是渲染树，而不是打开浏览器调试看到的DOM)中消失，渲染的时候不占据任何空间； <code>visibility: hidden;</code>不会让元素从渲染树消失，渲染师元素继续占据空间，只是内容不可见</li>
<li><code>display: none;</code>是非继承属性，子孙节点消失由于元素从渲染树消失造成，通过修改子孙节点属性无法显示； <code>visibility: hidden;</code>是继承属性，子孙节点消失由于继承了hidden，通过设置<code>visibility: visible;</code>可以让子孙节点显示；</li>
<li>修改常规流中元素的<code>display</code>通常会造成文档<strong>重排</strong>。修改<code>visibility</code>属性只会造成本元素的<strong>重绘</strong>。</li>
<li>读屏器不会读取<code>display: none;</code>元素内容；会读取<code>visibility: hidden;</code>元素内容</li>
</ul>
<p>但是，我们今天要讲的并不是这两个的区别，我们要说的是<code>visibility</code>的一个<strong>不</strong>广为人知的属性: <code>collapse</code></p>
<h3>一、visibility: collapse详解</h3>
<p>按照<a href="https://www.w3.org/TR/CSS22/visufx.html">W3C</a>的说法, <code>visibility: collapse</code>只能用在rows, row groups, columns, column groups 元素上，用在任何其它元素上的效果等同于<code>visibility: hidden</code>。</p>
<p>那么<code>rows, row groups, columns, column groups</code> 元素都是指哪些元素呢？实际上<code>row</code>就是指HTML中的<code>TR</code>元素，<code>row groups</code>就是指HTML中的<code>TBODY、THEAD、TFOOT</code>元素，<code>columns</code>就是指HTML中的<code>COL</code>元素，<code>column groups</code>就是指HTML中的<code>COLGROUP</code>元素。</p>
<p>也就是说，<code>visibility: collapse</code>只能用在<code>TR、TBODY、THEAD、TFOOT、COL、COLGROUP</code>元素上。</p>
<p>那么当<code>visibility: collapse</code>用在这几个属性上时会起到什么效果呢？</p>
<p>W3C的原话是这么说的：</p>
<blockquote>
<p>This value causes the entire row or column to be removed from the display, and the space normally taken up by the row or column to be made available for other content. Contents of spanned rows and columns that intersect the collapsed column or row are clipped. The suppression of the row or column, however, does not otherwise affect the layout of the table. This allows dynamic effects to remove table rows or columns without forcing a re-layout of the table in order to account for the potential change in column constraints.</p>
</blockquote>
<p>翻译成白话就是：</p>
<blockquote>
<p>元素使用这个属性会导致整行或者整列会从视觉上被移除，也就是视觉上(注意仅仅只是视觉上)达到display: none的效果。元素原来所占据的空间会被表格的其它内容填充。如果用到了spanned，那么内容会被裁剪。使用这个属性不会影响整个表格的布局。这个属性的好处在于可以实现一种动态增加或删除表格行或者列的效果，并且不会导致重排。</p>
</blockquote>
<p>更白话的说法就是，这个属性可以在视觉上达到<code>display: none</code>的效果，但是和<code>display: none</code>的区别在于DOM并<strong>没有</strong>从渲染树中移除，所以也<strong>不会重排</strong>，只会有类似于<code>visibility: hidden</code>那样一个重绘的过程，这样可以以较低的开销实现表格行/列动态改变的效果。</p>
<p>我们可以以下面的例子来看看效果， 我们的HTML例子如下：</p>
<pre><code>&lt;table&gt;
    &lt;caption&gt;table title and/or explanatory text&lt;/caption&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;header1&lt;/th&gt;
            &lt;th&gt;header2&lt;/th&gt;
            &lt;th&gt;header3&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
        &lt;tr&gt;
            &lt;td&gt;dataA&lt;/td&gt;
            &lt;td&gt;dataA&lt;/td&gt;
            &lt;td&gt;dataA&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr class=&quot;test&quot;&gt;
            &lt;td&gt;dataB&lt;/td&gt;
            &lt;td&gt;dataB&lt;/td&gt;
            &lt;td&gt;dataB&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;dataC&lt;/td&gt;
            &lt;td&gt;dataC&lt;/td&gt;
            &lt;td&gt;dataC&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
</code></pre>

<p>当不使用任何属性的时候，效果如下：</p>
<p><img src="https://i.imgur.com/19xLNZR.jpg" /></p>
<p><strong>1、 对tr使用visibility: hidden属性</strong></p>
<p>现在我们对表体的第二行test类使用<code>visibility: hidden</code>属性：</p>
<pre><code>.test {
    visibility: hidden;
}
</code></pre>

<p>我们看看效果：</p>
<p><img src="https://i.imgur.com/2fkQMpS.jpg" /></p>
<p>我们可以看到，第二行的空间任然被占用着，也就是说第二行的DOM也在渲染树中。</p>
<p>这是<code>visibility: hidden</code>的固有效果，符合我们的预期，没有什么可说的。接下来我们对比一下熟悉的<code>display: none</code>效果。</p>
<p><strong>2、 对tr使用display: none属性</strong></p>
<pre><code>.test {
    display: none
}
</code></pre>

<p>当使用<code>display: none</code>后，页面效果如下：</p>
<p><img src="https://i.imgur.com/V7kVyNX.jpg" /></p>
<p>可见，第二行的空间被移除，也就是说第二行的DOM已经从渲染树中移除(注意，只是从渲染树种移除，实际DOM中还是存在该行的DOM，要注意区分)。</p>
<p><strong>3、 对tr使用visibility: collapse属性</strong></p>
<pre><code>.test {
    visibility: collapse
}
</code></pre>

<p>当使用<code>visibility: collapse</code>后，页面效果如下：</p>
<p><img src="https://i.imgur.com/V7kVyNX.jpg" /></p>
<h3>二、 结论</h3>
<p><code>visibility: collapse</code>只能用在<code>TR、TBODY、THEAD、TFOOT、COL、COLGROUP</code>元素上。这个属性可以在视觉上达到<code>display: none</code>的效果，但是和<code>display: none</code>的区别在于DOM并<strong>没有</strong>从渲染树中移除，所以也<strong>不会重排</strong>，只会有类似于<code>visibility: hidden</code>那样一个重绘的过程，这样可以以较低的开销实现表格行/列动态改变的效果。</p>

</body>
</html>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
